With new dataset:
Epoch 0  test_dr 0.000 0.794  train_dr 0.198 1.786  test_mse 8.61528 8.58898  train_mse 8.62022 8.59262
Epoch 1  test_dr 15.476 15.873  train_dr 36.706 36.706  test_mse 7.52835 7.25400  train_mse 4.17397 5.56644
Epoch 2  test_dr 16.865 15.675  train_dr 50.794 49.405  test_mse 7.90078 6.97844  train_mse 3.70297 4.42320
Epoch 3  test_dr 18.254 18.254  train_dr 64.881 65.873  test_mse 8.39269 7.02307  train_mse 3.26297 3.70741
Epoch 4  test_dr 18.254 18.651  train_dr 79.167 76.984  test_mse 8.39787 6.90702  train_mse 2.98546 3.25883
Epoch 5  test_dr 15.873 16.468  train_dr 91.468 92.460  test_mse 9.48814 6.97696  train_mse 2.74269 2.90476
Epoch 6  test_dr 19.444 19.841  train_dr 97.024 95.635  test_mse 8.88643 6.84022  train_mse 2.62723 2.73492
Epoch 7  test_dr 18.452 20.040  train_dr 99.603 98.810  test_mse 8.66152 6.71698  train_mse 2.54862 2.62100
Epoch 8  test_dr 18.056 19.246  train_dr 98.810 99.206  test_mse 8.78981 6.80892  train_mse 2.47523 2.52463
Epoch 9  test_dr 21.429 21.825  train_dr 98.810 98.611  test_mse 8.44010 6.68370  train_mse 2.46728 2.48910
Epoch 10  test_dr 17.857 19.444  train_dr 99.008 98.611  test_mse 8.78984 6.81747  train_mse 2.44820 2.47467
Epoch 11  test_dr 24.008 25.000  train_dr 100.000 99.802  test_mse 8.02641 6.62794  train_mse 2.41299 2.42559
Epoch 12  test_dr 18.452 22.222  train_dr 100.000 100.000  test_mse 8.57446 6.72109  train_mse 2.37430 2.39700
Epoch 13  test_dr 21.429 23.016  train_dr 100.000 100.000  test_mse 7.96488 6.70447  train_mse 2.37989 2.38647
Epoch 14  test_dr 21.032 22.817  train_dr 100.000 100.000  test_mse 8.44009 6.79646  train_mse 2.35030 2.35173
Epoch 15  test_dr 20.437 23.611  train_dr 100.000 100.000  test_mse 7.70393 6.63765  train_mse 2.36201 2.36082
Epoch 16  test_dr 18.651 19.444  train_dr 100.000 100.000  test_mse 8.43329 6.77700  train_mse 2.34279 2.35455
Epoch 17  test_dr 19.246 20.635  train_dr 99.802 99.802  test_mse 8.10026 6.73913  train_mse 2.36917 2.36642
Epoch 18  test_dr 22.817 22.421  train_dr 98.810 99.603  test_mse 8.00730 6.77764  train_mse 2.39245 2.37818
Epoch 19  test_dr 23.611 24.405  train_dr 99.802 100.000  test_mse 7.97565 6.69271  train_mse 2.37988 2.37716
Epoch 20  test_dr 23.810 25.000  train_dr 100.000 100.000  test_mse 7.94760 6.73956  train_mse 2.34511 2.33831
Epoch 21  test_dr 22.817 25.000  train_dr 100.000 100.000  test_mse 7.87455 6.72805  train_mse 2.32368 2.31245
Epoch 22  test_dr 24.802 27.579  train_dr 100.000 100.000  test_mse 7.57925 6.67226  train_mse 2.22903 2.19513
Epoch 23  test_dr 26.190 27.381  train_dr 100.000 100.000  test_mse 7.88069 6.81386  train_mse 2.19663 2.16557
Epoch 24  test_dr 25.992 27.778  train_dr 100.000 100.000  test_mse 7.83108 6.83841  train_mse 2.18540 2.15817
Epoch 25  test_dr 26.587 28.373  train_dr 100.000 100.000  test_mse 8.05676 6.91277  train_mse 2.17297 2.14846
Epoch 26  test_dr 26.587 27.976  train_dr 100.000 100.000  test_mse 8.11476 6.94343  train_mse 2.16678 2.14548
Epoch 27  test_dr 27.778 28.175  train_dr 100.000 100.000  test_mse 8.17951 6.97209  train_mse 2.16465 2.14185
Epoch 28  test_dr 26.587 27.579  train_dr 100.000 100.000  test_mse 8.32974 7.01232  train_mse 2.15961 2.13879
Epoch 29  test_dr 25.992 27.976  train_dr 100.000 100.000  test_mse 8.35306 7.02984  train_mse 2.15563 2.13581
Epoch 30  test_dr 26.190 27.778  train_dr 100.000 100.000  test_mse 8.41798 7.05321  train_mse 2.15317 2.13258
Done in 42.05 min


With previous dataset:
Epoch 0  test_dr 1.190 1.587  train_dr 0.794 1.786  test_mse 8.58449 8.58699  train_mse 8.58339 8.58699
Epoch 1  test_dr 20.238 21.230  train_dr 25.397 24.008  test_mse 5.77071 6.96891  train_mse 5.26684 6.78637
Epoch 2  test_dr 25.198 26.190  train_dr 42.659 43.452  test_mse 5.55583 6.39808  train_mse 4.45203 5.76784
Epoch 3  test_dr 29.960 29.563  train_dr 56.151 55.357  test_mse 5.38262 5.89165  train_mse 3.91441 4.83047
Epoch 4  test_dr 23.810 28.571  train_dr 75.595 78.175  test_mse 5.51789 5.62660  train_mse 3.34437 3.75144
Epoch 5  test_dr 27.976 31.746  train_dr 86.508 87.698  test_mse 5.62593 5.40828  train_mse 2.95669 3.16326
Epoch 6  test_dr 25.397 28.770  train_dr 92.063 93.056  test_mse 5.72002 5.39947  train_mse 2.81847 2.90192
Epoch 7  test_dr 30.556 33.333  train_dr 96.627 96.429  test_mse 5.57267 5.31284  train_mse 2.66643 2.74409
Epoch 8  test_dr 24.206 27.183  train_dr 97.024 97.222  test_mse 5.58448 5.31970  train_mse 2.63931 2.66480
Epoch 9  test_dr 26.984 30.357  train_dr 98.016 98.413  test_mse 5.56159 5.35222  train_mse 2.59531 2.62589
Epoch 10  test_dr 31.746 34.921  train_dr 98.413 98.413  test_mse 5.43656 5.26617  train_mse 2.55684 2.56991
Epoch 11  test_dr 25.000 28.175  train_dr 98.214 98.611  test_mse 5.50493 5.30110  train_mse 2.51804 2.54019
Epoch 12  test_dr 32.143 33.929  train_dr 97.817 98.016  test_mse 5.41113 5.25656  train_mse 2.48560 2.51027
Epoch 13  test_dr 30.159 33.135  train_dr 98.413 99.008  test_mse 5.35670 5.17832  train_mse 2.50156 2.48805
Epoch 14  test_dr 30.159 33.929  train_dr 99.008 99.206  test_mse 5.49997 5.39328  train_mse 2.47710 2.49480
Epoch 15  test_dr 35.119 36.706  train_dr 99.405 99.405  test_mse 5.23011 5.14808  train_mse 2.45867 2.43283
Epoch 16  test_dr 33.333 36.111  train_dr 99.405 99.405  test_mse 5.19852 5.13097  train_mse 2.41323 2.40032
Epoch 17  test_dr 35.516 40.675  train_dr 99.405 99.206  test_mse 5.33108 5.20531  train_mse 2.41205 2.39239
Epoch 18  test_dr 35.913 37.500  train_dr 99.603 99.802  test_mse 5.16602 5.07280  train_mse 2.42032 2.39535
Epoch 19  test_dr 35.119 37.698  train_dr 98.810 98.810  test_mse 5.30285 5.19076  train_mse 2.44101 2.41812
Epoch 20  test_dr 33.333 35.317  train_dr 99.206 99.405  test_mse 5.21775 5.12334  train_mse 2.41322 2.39281
Epoch 21  test_dr 34.325 36.905  train_dr 98.413 99.206  test_mse 5.26423 5.16912  train_mse 2.43025 2.39190
Epoch 22  test_dr 40.476 41.667  train_dr 99.405 99.603  test_mse 5.06599 5.04647  train_mse 2.28295 2.23024
Epoch 23  test_dr 40.873 42.659  train_dr 99.603 99.603  test_mse 5.07594 5.07365  train_mse 2.25175 2.21078
Epoch 24  test_dr 38.690 41.270  train_dr 99.603 99.603  test_mse 5.15917 5.15197  train_mse 2.21926 2.19208
Epoch 25  test_dr 40.278 42.063  train_dr 99.603 99.802  test_mse 5.16171 5.16467  train_mse 2.19982 2.16822
Epoch 26  test_dr 39.286 41.667  train_dr 99.603 99.802  test_mse 5.20631 5.19607  train_mse 2.20766 2.17323
Epoch 27  test_dr 39.683 41.865  train_dr 99.603 99.802  test_mse 5.23698 5.20268  train_mse 2.19835 2.16799
Epoch 28  test_dr 39.683 41.865  train_dr 99.603 99.802  test_mse 5.22817 5.22590  train_mse 2.19271 2.16235
Epoch 29  test_dr 40.476 42.063  train_dr 99.603 100.000  test_mse 5.24963 5.24105  train_mse 2.18750 2.15805
Epoch 30  test_dr 39.484 41.468  train_dr 99.603 99.802  test_mse 5.24779 5.24529  train_mse 2.18525 2.15739
Done in 27.18 min



1 bank: 21.875
2 banks: 23.828
3 banks: 24.609


-----n_train, n_test = 1024, 512-----
Randomize test/train subsets:
3 banks + diff number of filters: 27, 28, 29

CE on top of CE: 30% (best: 32.6%)

CE in loop: 26% (max 27%)

just CE: yes

avg_pool: 26-29% no
concat: 28% no
max+concat: 25% - 30% no
max+sum/3: 26% - 31% yes
9x9 kernel: 22% - 27% no
3x3 kernel: 29% - 33% yes
1x1 kernel: 24 - 28% no

full da: 38% yes
da + wd: 49% yes

full dataset, lambda=0.01: PD: 36% (5 h), PD+SM: 52.877% 57.738% (7.5h, 7.5 min/epoch)


best: lambda=0.1 (adam lr=0.001)
Epoch 0  test_dr 0.488 0.488  train_dr 0.391 0.391  test_mse 8.58230 8.58230  train_mse 8.58668 8.58668
Epoch 1  test_dr 17.285 17.285  train_dr 30.078 30.078  test_mse 5.74641 5.74641  train_mse 5.26313 5.26313
Epoch 2  test_dr 22.461 22.461  train_dr 38.477 38.477  test_mse 5.80371 5.80371  train_mse 5.07314 5.07314
Epoch 3  test_dr 21.973 21.973  train_dr 39.648 39.648  test_mse 5.81745 5.81745  train_mse 4.91401 4.91401
Epoch 4  test_dr 28.223 28.223  train_dr 50.391 50.391  test_mse 5.57582 5.57582  train_mse 4.55565 4.55565
Epoch 5  test_dr 22.559 22.559  train_dr 48.633 48.633  test_mse 5.74632 5.74632  train_mse 4.47440 4.47440
Epoch 6  test_dr 26.953 26.953  train_dr 50.586 50.586  test_mse 5.63731 5.63731  train_mse 4.47383 4.47383
Epoch 7  test_dr 20.117 20.117  train_dr 47.070 47.070  test_mse 5.90558 5.90558  train_mse 4.59646 4.59646
Epoch 8  test_dr 23.242 23.242  train_dr 53.809 53.809  test_mse 5.85448 5.85448  train_mse 4.49265 4.49265
Epoch 9  test_dr 25.781 25.781  train_dr 59.570 59.570  test_mse 5.75524 5.75524  train_mse 4.31031 4.31031
Epoch 10  test_dr 24.902 24.902  train_dr 56.641 56.641  test_mse 6.20170 6.20170  train_mse 4.60215 4.60215
Epoch 11  test_dr 28.809 28.809  train_dr 59.570 59.570  test_mse 5.70655 5.70655  train_mse 4.26673 4.26673
Epoch 12  test_dr 31.641 31.641  train_dr 63.086 63.086  test_mse 5.61025 5.61025  train_mse 4.13241 4.13241
Epoch 13  test_dr 24.219 24.219  train_dr 65.137 65.137  test_mse 5.70982 5.70982  train_mse 4.18282 4.18282
Epoch 14  test_dr 25.488 25.488  train_dr 64.160 64.160  test_mse 6.15454 6.15454  train_mse 4.12841 4.12841
Epoch 15  test_dr 24.023 24.023  train_dr 56.152 56.152  test_mse 5.79291 5.79291  train_mse 4.27191 4.27191
Epoch 16  test_dr 30.273 30.273  train_dr 67.090 67.090  test_mse 5.55673 5.55673  train_mse 4.13622 4.13622
Epoch 17  test_dr 29.785 29.785  train_dr 72.852 72.852  test_mse 5.83686 5.83686  train_mse 3.92885 3.92885
Epoch 18  test_dr 29.980 29.980  train_dr 73.828 73.828  test_mse 5.68080 5.68080  train_mse 3.87922 3.87922
Epoch 19  test_dr 19.531 19.531  train_dr 63.086 63.086  test_mse 5.88047 5.88047  train_mse 4.09675 4.09675
Epoch 20  test_dr 24.023 24.023  train_dr 66.602 66.602  test_mse 5.83490 5.83490  train_mse 4.15203 4.15203
Epoch 21  test_dr 33.887 33.887  train_dr 74.316 74.316  test_mse 5.61318 5.61318  train_mse 3.78175 3.78175
Epoch 22  test_dr 34.375 34.375  train_dr 91.406 91.406  test_mse 5.38137 5.38137  train_mse 3.37494 3.37494
Epoch 23  test_dr 33.398 33.398  train_dr 92.480 92.480  test_mse 5.32451 5.32451  train_mse 3.34036 3.34036
Epoch 24  test_dr 33.301 33.301  train_dr 92.969 92.969  test_mse 5.35874 5.35874  train_mse 3.33120 3.33120
Epoch 25  test_dr 38.574 38.574  train_dr 96.875 96.875  test_mse 5.30792 5.30792  train_mse 3.11995 3.11995
Epoch 26  test_dr 36.914 36.914  train_dr 96.777 96.777  test_mse 5.43033 5.43033  train_mse 3.07384 3.07384
Epoch 27  test_dr 35.449 35.449  train_dr 96.484 96.484  test_mse 5.48463 5.48463  train_mse 3.07576 3.07576
Epoch 28  test_dr 35.449 35.449  train_dr 96.973 96.973  test_mse 5.57619 5.57619  train_mse 3.00432 3.00432
Epoch 29  test_dr 35.449 35.449  train_dr 96.875 96.875  test_mse 5.64075 5.64075  train_mse 2.99745 2.99745
Epoch 30  test_dr 35.742 35.742  train_dr 97.168 97.168  test_mse 5.54138 5.54138  train_mse 2.98939 2.98939
Done in 18.05 min



4000 ex, PD+SM
Epoch: 1  test_mse_pd: 0.57331  test_mse_sm: 0.57120  train_mse_pd: 0.61293  train_mse_sm: 0.61358
Epoch: 2  test_ms0e_pd: 0.51564  test_mse_sm: 0.50628  train_mse_pd: 0.54552  train_mse_sm: 0.54090
Epoch: 3  test_mse_pd: 0.49746  test_mse_sm: 0.49380  train_mse_pd: 0.50238  train_mse_sm: 0.49926
Epoch: 4  test_mse_pd: 0.45556  test_mse_sm: 0.44834  train_mse_pd: 0.43717  train_mse_sm: 0.42879
Epoch: 5  test_mse_pd: 0.46716  test_mse_sm: 0.46583  train_mse_pd: 0.43273  train_mse_sm: 0.42895
Epoch: 6  test_mse_pd: 0.45456  test_mse_sm: 0.45511  train_mse_pd: 0.37205  train_mse_sm: 0.36574
Epoch: 7  test_mse_pd: 0.44871  test_mse_sm: 0.45108  train_mse_pd: 0.32275  train_mse_sm: 0.31598
Epoch: 8  test_mse_pd: 0.43317  test_mse_sm: 0.43588  train_mse_pd: 0.27921  train_mse_sm: 0.26996
Epoch: 9  test_mse_pd: 0.44514  test_mse_sm: 0.44619  train_mse_pd: 0.25047  train_mse_sm: 0.24207
Epoch: 10  test_mse_pd: 0.44959  test_mse_sm: 0.45453  train_mse_pd: 0.23164  train_mse_sm: 0.22305
Epoch: 11  test_mse_pd: 0.43278  test_mse_sm: 0.43614  train_mse_pd: 0.17644  train_mse_sm: 0.17183
Epoch: 12  test_mse_pd: 0.43733  test_mse_sm: 0.44151  train_mse_pd: 0.15243  train_mse_sm: 0.14986
Epoch: 13  test_mse_pd: 0.44000  test_mse_sm: 0.44459  train_mse_pd: 0.13000  train_mse_sm: 0.12746
Epoch: 14  test_mse_pd: 0.44391  test_mse_sm: 0.44910  train_mse_pd: 0.12076  train_mse_sm: 0.11887
Epoch: 15  test_mse_pd: 0.44799  test_mse_sm: 0.45307  train_mse_pd: 0.11719  train_mse_sm: 0.11472
Done in 77.90 min

4000 ex, pure PD.
Epoch: 1  test_mse_pd: 0.62301  test_mse_sm: 0.62301  train_mse_pd: 0.65380  train_mse_sm: 0.65380
Epoch: 2  test_mse_pd: 0.56976  test_mse_sm: 0.56976  train_mse_pd: 0.59688  train_mse_sm: 0.59688
Epoch: 3  test_mse_pd: 0.51294  test_mse_sm: 0.51294  train_mse_pd: 0.52066  train_mse_sm: 0.52066
Epoch: 4  test_mse_pd: 0.48197  test_mse_sm: 0.48197  train_mse_pd: 0.47636  train_mse_sm: 0.47636
Epoch: 5  test_mse_pd: 0.46185  test_mse_sm: 0.46185  train_mse_pd: 0.42532  train_mse_sm: 0.42532
Epoch: 6  test_mse_pd: 0.44167  test_mse_sm: 0.44167  train_mse_pd: 0.38025  train_mse_sm: 0.38025
Epoch: 7  test_mse_pd: 0.44875  test_mse_sm: 0.44875  train_mse_pd: 0.35115  train_mse_sm: 0.35115
Epoch: 8  test_mse_pd: 0.44653  test_mse_sm: 0.44653  train_mse_pd: 0.32225  train_mse_sm: 0.32225
Epoch: 9  test_mse_pd: 0.46311  test_mse_sm: 0.46311  train_mse_pd: 0.28288  train_mse_sm: 0.28288
Epoch: 10  test_mse_pd: 0.46362  test_mse_sm: 0.46362  train_mse_pd: 0.26210  train_mse_sm: 0.26210
Epoch: 11  test_mse_pd: 0.45307  test_mse_sm: 0.45307  train_mse_pd: 0.19355  train_mse_sm: 0.19355
Epoch: 12  test_mse_pd: 0.45575  test_mse_sm: 0.45575  train_mse_pd: 0.17061  train_mse_sm: 0.17061
Epoch: 13  test_mse_pd: 0.45258  test_mse_sm: 0.45258  train_mse_pd: 0.13716  train_mse_sm: 0.13716
Epoch: 14  test_mse_pd: 0.46442  test_mse_sm: 0.46442  train_mse_pd: 0.12404  train_mse_sm: 0.12404
Epoch: 15  test_mse_pd: 0.46570  test_mse_sm: 0.46570  train_mse_pd: 0.11771  train_mse_sm: 0.11771
Done in 72.91 min





First succ run, lr=0.001,
init /10, batch=10
Epoch: 0  test err: 0.34542  train err: 0.34542
Epoch: 1  test err: 0.34238  train err: 0.34238
Epoch: 2  test err: 0.34330  train err: 0.34330
Epoch: 3  test err: 0.34467  train err: 0.34467
Epoch: 4  test err: 0.33704  train err: 0.33704
Epoch: 5  test err: 0.32818  train err: 0.32818
Epoch: 6  test err: 0.31553  train err: 0.31553
Epoch: 7  test err: 0.31856  train err: 0.31856
Epoch: 8  test err: 0.31268  train err: 0.31268
Epoch: 9  test err: 0.30857  train err: 0.30857
Epoch: 10  test err: 0.30597  train err: 0.30597
Epoch: 11  test err: 0.30829  train err: 0.30829
Epoch: 12  test err: 0.30396  train err: 0.30396
Epoch: 13  test err: 0.30121  train err: 0.30121
Epoch: 14  test err: 0.29114  train err: 0.29114
Epoch: 15  test err: 0.29430  train err: 0.29430
Epoch: 16  test err: 0.29038  train err: 0.29038
Epoch: 17  test err: 0.28856  train err: 0.28856
Epoch: 18  test err: 0.28729  train err: 0.28729
Epoch: 19  test err: 0.27777  train err: 0.27777
Epoch: 20  test err: 0.28072  train err: 0.28072
Epoch: 21  test err: 0.26465  train err: 0.26465
Epoch: 22  test err: 0.26483  train err: 0.26483
Epoch: 23  test err: 0.25894  train err: 0.25894
Epoch: 24  test err: 0.25162  train err: 0.25162
Epoch: 25  test err: 0.25622  train err: 0.25622
Epoch: 26  test err: 0.25126  train err: 0.25126
Epoch: 27  test err: 0.25781  train err: 0.25781
Epoch: 28  test err: 0.25177  train err: 0.25177
Epoch: 29  test err: 0.24999  train err: 0.24999
Epoch: 30  test err: 0.24943  train err: 0.24943



lr, optimizer = 0.1, 'momentum'
he init, batch=10
Epoch: 0  test err: 0.34542  train err: 0.34542
Epoch: 1  test err: 0.34388  train err: 0.34388
Epoch: 2  test err: 0.34241  train err: 0.34241
Epoch: 3  test err: 0.34033  train err: 0.34033
Epoch: 4  test err: 0.34255  train err: 0.34255
Epoch: 5  test err: 0.32851  train err: 0.32851
Epoch: 6  test err: 0.33093  train err: 0.33093
Epoch: 7  test err: 0.32457  train err: 0.32457
Epoch: 8  test err: 0.31210  train err: 0.31210
Epoch: 9  test err: 0.31633  train err: 0.31633
Epoch: 10  test err: 0.29962  train err: 0.29962
Epoch: 11  test err: 0.28982  train err: 0.28982
Epoch: 12  test err: 0.30259  train err: 0.30259
Epoch: 13  test err: 0.28692  train err: 0.28692
Epoch: 14  test err: 0.28947  train err: 0.28947
Epoch: 15  test err: 0.27815  train err: 0.27815
Epoch: 16  test err: 0.26360  train err: 0.26360
Epoch: 17  test err: 0.26874  train err: 0.26874
Epoch: 18  test err: 0.26232  train err: 0.26232
Epoch: 19  test err: 0.25903  train err: 0.25903
Epoch: 20  test err: 0.27946  train err: 0.27946
Epoch: 21  test err: 0.25141  train err: 0.25141
Epoch: 22  test err: 0.22342  train err: 0.22342
Epoch: 23  test err: 0.21877  train err: 0.21877
Epoch: 24  test err: 0.21333  train err: 0.21333
Epoch: 25  test err: 0.20356  train err: 0.20356
Epoch: 26  test err: 0.20219  train err: 0.20219
Epoch: 27  test err: 0.19622  train err: 0.19622
Epoch: 28  test err: 0.19385  train err: 0.19385
Epoch: 29  test err: 0.19299  train err: 0.19299
Epoch: 30  test err: 0.18957  train err: 0.18957


lr, optimizer = 0.1, 'momentum'
he init, batch=5
Epoch: 0  test err: 0.34542  train err: 0.34542
Epoch: 1  test err: 0.33835  train err: 0.33835
Epoch: 2  test err: 0.33299  train err: 0.33299
Epoch: 3  test err: 0.31788  train err: 0.31788
Epoch: 4  test err: 0.32815  train err: 0.32815
Epoch: 5  test err: 0.31381  train err: 0.31381
Epoch: 6  test err: 0.29982  train err: 0.29982
Epoch: 7  test err: 0.30050  train err: 0.30050
Epoch: 8  test err: 0.28621  train err: 0.28621
Epoch: 9  test err: 0.29893  train err: 0.29893
Epoch: 10  test err: 0.26606  train err: 0.26606
Epoch: 11  test err: 0.27566  train err: 0.27566
Epoch: 12  test err: 0.25317  train err: 0.25317
Epoch: 13  test err: 0.26107  train err: 0.26107
Epoch: 14  test err: 0.25115  train err: 0.25115
Epoch: 15  test err: 0.23323  train err: 0.23323
Epoch: 16  test err: 0.24622  train err: 0.24622
Epoch: 17  test err: 0.21970  train err: 0.21970
Epoch: 18  test err: 0.21910  train err: 0.21910
Epoch: 19  test err: 0.21347  train err: 0.21347
Epoch: 20  test err: 0.19117  train err: 0.19117
Epoch: 21  test err: 0.18949  train err: 0.18949
Epoch: 22  test err: 0.16328  train err: 0.16328
Epoch: 23  test err: 0.16490  train err: 0.16490
Epoch: 24  test err: 0.15355  train err: 0.15355
Epoch: 25  test err: 0.13926  train err: 0.13926
Epoch: 26  test err: 0.13703  train err: 0.13703
Epoch: 27  test err: 0.13274  train err: 0.13274
Epoch: 28  test err: 0.12985  train err: 0.12985
Epoch: 29  test err: 0.12842  train err: 0.12842
Epoch: 30  test err: 0.12835  train err: 0.12835


lr, optimizer = 1.0, 'momentum'
he init, batch=5
too high, no progress



lr, optimizer = 1.0, 'adam'
he init, batch=5
too high, divergence


lr, optimizer = 0.01, 'adam'
he init, batch=5
too high, no progress


lr, optimizer = 0.001, 'adam'
he init, batch=5
best
Epoch: 0  test err: 0.34545  train err: 0.34557
Epoch: 1  test err: 0.34240  train err: 0.34178
Epoch: 2  test err: 0.34395  train err: 0.34319
Epoch: 3  test err: 0.34114  train err: 0.33848
Epoch: 4  test err: 0.34131  train err: 0.33017
Epoch: 5  test err: 0.34672  train err: 0.33415
Epoch: 6  test err: 0.36858  train err: 0.32782
Epoch: 7  test err: 0.35304  train err: 0.32190
Epoch: 8  test err: 0.36211  train err: 0.31892
Epoch: 9  test err: 0.39991  train err: 0.29248
Epoch: 10  test err: 0.39724  train err: 0.27096
Epoch: 11  test err: 0.36443  train err: 0.25640
Epoch: 12  test err: 0.41655  train err: 0.22004
Epoch: 13  test err: 0.40147  train err: 0.21860
Epoch: 14  test err: 0.42255  train err: 0.19909
Epoch: 15  test err: 0.44437  train err: 0.17034
Epoch: 16  test err: 0.42481  train err: 0.16705
Epoch: 17  test err: 0.43262  train err: 0.15240
Epoch: 18  test err: 0.43674  train err: 0.14020
Epoch: 19  test err: 0.44686  train err: 0.14014
Epoch: 20  test err: 0.43074  train err: 0.13351
Epoch: 21  test err: 0.42055  train err: 0.11671
Epoch: 22  test err: 0.42466  train err: 0.09947
Epoch: 23  test err: 0.43200  train err: 0.09441
Epoch: 24  test err: 0.43020  train err: 0.09591
Epoch: 25  test err: 0.43582  train err: 0.08601
Epoch: 26  test err: 0.43750  train err: 0.08359
Epoch: 27  test err: 0.44111  train err: 0.08189
Epoch: 28  test err: 0.44310  train err: 0.08043
Epoch: 29  test err: 0.44627  train err: 0.07924
Epoch: 30  test err: 0.44584  train err: 0.07873


lr, optimizer = 0.0001, 'adam'
he init, batch=5
much worse! around 0.20 in the end


lr, optimizer = 0.001, 'adam'
he init, batch=5, 500 train images
best
Epoch: 0  test err: 0.34564  train err: 0.34551
Epoch: 1  test err: 0.34523  train err: 0.34175
Epoch: 2  test err: 0.34374  train err: 0.34006
Epoch: 3  test err: 0.34535  train err: 0.34332
Epoch: 4  test err: 0.35045  train err: 0.33254
Epoch: 5  test err: 0.42968  train err: 0.30494
Epoch: 6  test err: 0.38192  train err: 0.31496
Epoch: 7  test err: 0.42305  train err: 0.28156
Epoch: 8  test err: 0.43156  train err: 0.26942
Epoch: 9  test err: 0.41469  train err: 0.25686
Epoch: 10  test err: 0.43445  train err: 0.23859
Epoch: 11  test err: 0.42381  train err: 0.22845
Epoch: 12  test err: 0.41978  train err: 0.21396
Epoch: 13  test err: 0.47640  train err: 0.19005
Epoch: 14  test err: 0.46471  train err: 0.19659
Epoch: 15  test err: 0.48092  train err: 0.16859
Epoch: 16  test err: 0.48087  train err: 0.16168
Epoch: 17  test err: 0.46045  train err: 0.16031
Epoch: 18  test err: 0.47103  train err: 0.14863
Epoch: 19  test err: 0.46345  train err: 0.14192
Epoch: 20  test err: 0.46839  train err: 0.13238
Epoch: 21  test err: 0.44470  train err: 0.12758
Epoch: 22  test err: 0.46362  train err: 0.10577
Epoch: 23  test err: 0.49002  train err: 0.10121
Epoch: 24  test err: 0.44780  train err: 0.09635
Epoch: 25  test err: 0.47694  train err: 0.08909
Epoch: 26  test err: 0.47405  train err: 0.08825
Epoch: 27  test err: 0.46540  train err: 0.08525
Epoch: 28  test err: 0.46873  train err: 0.08367
Epoch: 29  test err: 0.48264  train err: 0.08163
Epoch: 30  test err: 0.47821  train err: 0.08016



lr, optimizer = 0.001, 'adam'
he init, batch=10, 500 train images
batch=10 == batch=5 (almost), but a bit faster
Epoch: 0  test err: 0.34563  train err: 0.34562
Epoch: 1  test err: 0.34378  train err: 0.33999
Epoch: 2  test err: 0.34686  train err: 0.33458
Epoch: 3  test err: 0.35680  train err: 0.32746
Epoch: 4  test err: 0.37005  train err: 0.32251
Epoch: 5  test err: 0.37732  train err: 0.29662
Epoch: 6  test err: 0.40125  train err: 0.29244
Epoch: 7  test err: 0.41210  train err: 0.26932
Epoch: 8  test err: 0.40495  train err: 0.25626
Epoch: 9  test err: 0.42934  train err: 0.24107
Epoch: 10  test err: 0.44261  train err: 0.22934
Epoch: 11  test err: 0.44960  train err: 0.20196
Epoch: 12  test err: 0.43450  train err: 0.20107
Epoch: 13  test err: 0.44692  train err: 0.19188
Epoch: 14  test err: 0.43889  train err: 0.17903
Epoch: 15  test err: 0.45752  train err: 0.16987
Epoch: 16  test err: 0.47156  train err: 0.17000
Epoch: 17  test err: 0.49230  train err: 0.15239
Epoch: 18  test err: 0.43618  train err: 0.15761
Epoch: 19  test err: 0.44632  train err: 0.14481
Epoch: 20  test err: 0.41351  train err: 0.14464
Epoch: 21  test err: 0.49597  train err: 0.12908
Epoch: 22  test err: 0.46448  train err: 0.11804
Epoch: 23  test err: 0.44586  train err: 0.10895
Epoch: 24  test err: 0.46482  train err: 0.10677
Epoch: 25  test err: 0.47564  train err: 0.09861
Epoch: 26  test err: 0.46960  train err: 0.09750
Epoch: 27  test err: 0.47356  train err: 0.09669
Epoch: 28  test err: 0.47365  train err: 0.09476
Epoch: 29  test err: 0.47222  train err: 0.09420
Epoch: 30  test err: 0.48280  train err: 0.09340



BN before, lr=0.001 (no significant difference whether do it before or after)
Epoch: 0  test err: 0.67103  train err: 0.67123
Epoch: 1  test err: 0.65662  train err: 0.66180
Epoch: 2  test err: 0.61683  train err: 0.65236
Epoch: 3  test err: 0.60893  train err: 0.58779
Epoch: 4  test err: 0.55288  train err: 0.55795
Epoch: 5  test err: 0.58391  train err: 0.52953
Epoch: 6  test err: 0.53474  train err: 0.42213
Epoch: 7  test err: 0.52900  train err: 0.40317
Epoch: 8  test err: 0.53783  train err: 0.37233
Epoch: 9  test err: 0.53733  train err: 0.41582
Epoch: 10  test err: 0.51145  train err: 0.35484
Epoch: 11  test err: 0.56050  train err: 0.33612
Epoch: 12  test err: 0.52399  train err: 0.28734
Epoch: 13  test err: 0.52032  train err: 0.25343
Epoch: 14  test err: 0.51966  train err: 0.25237
Epoch: 15  test err: 0.51736  train err: 0.23595
Epoch: 16  test err: 0.53475  train err: 0.22177
Epoch: 17  test err: 0.50863  train err: 0.20727
Epoch: 18  test err: 0.57918  train err: 0.21257
Epoch: 19  test err: 0.52350  train err: 0.18645
Epoch: 20  test err: 0.51631  train err: 0.19050
Epoch: 21  test err: 0.49459  train err: 0.16301
Epoch: 22  test err: 0.50785  train err: 0.16606
Epoch: 23  test err: 0.54229  train err: 0.18068
Epoch: 24  test err: 0.52102  train err: 0.15697
Epoch: 25  test err: 0.50134  train err: 0.16275
Epoch: 26  test err: 0.50804  train err: 0.13506
Epoch: 27  test err: 0.51297  train err: 0.14845
Epoch: 28  test err: 0.52826  train err: 0.14454
Epoch: 29  test err: 0.50669  train err: 0.16862
Epoch: 30  test err: 0.49456  train err: 0.13599
Epoch: 31  test err: 0.49601  train err: 0.13182
Epoch: 32  test err: 0.52939  train err: 0.13619
Epoch: 33  test err: 0.52139  train err: 0.11114
Epoch: 34  test err: 0.49423  train err: 0.11650
Epoch: 35  test err: 0.51337  train err: 0.10452
Epoch: 36  test err: 0.48968  train err: 0.10830
Epoch: 37  test err: 0.52513  train err: 0.10765
Epoch: 38  test err: 0.49559  train err: 0.08075
Epoch: 39  test err: 0.49447  train err: 0.13296
Epoch: 40  test err: 0.52330  train err: 0.09354
Epoch: 41  test err: 0.51186  train err: 0.09558
Epoch: 42  test err: 0.50582  train err: 0.09992
Epoch: 43  test err: 0.51959  train err: 0.07841
Epoch: 44  test err: 0.51051  train err: 0.09273
Epoch: 45  test err: 0.51782  train err: 0.09141
Epoch: 46  test err: 0.52429  train err: 0.07228
Epoch: 47  test err: 0.51629  train err: 0.06858
Epoch: 48  test err: 0.52066  train err: 0.07310
Epoch: 49  test err: 0.50087  train err: 0.06742
Epoch: 50  test err: 0.52236  train err: 0.07432
Epoch: 51  test err: 0.51789  train err: 0.08854
Epoch: 52  test err: 0.52022  train err: 0.06503
Epoch: 53  test err: 0.52475  train err: 0.06997
Epoch: 54  test err: 0.50847  train err: 0.07602
Epoch: 55  test err: 0.52641  train err: 0.06621
Epoch: 56  test err: 0.51390  train err: 0.06658
Epoch: 57  test err: 0.49921  train err: 0.04343
Epoch: 58  test err: 0.50696  train err: 0.04138
Epoch: 59  test err: 0.49244  train err: 0.03780
Epoch: 60  test err: 0.49502  train err: 0.03874
Epoch: 61  test err: 0.49797  train err: 0.04112
Epoch: 62  test err: 0.50386  train err: 0.03744
Epoch: 63  test err: 0.48944  train err: 0.04528
Epoch: 64  test err: 0.49369  train err: 0.03717
Epoch: 65  test err: 0.49764  train err: 0.03115
Epoch: 66  test err: 0.50012  train err: 0.03077
Epoch: 67  test err: 0.49995  train err: 0.03130
Epoch: 68  test err: 0.49323  train err: 0.02989
Epoch: 69  test err: 0.49658  train err: 0.03171
Epoch: 70  test err: 0.50423  train err: 0.03087
Epoch: 71  test err: 0.50769  train err: 0.03196
Epoch: 72  test err: 0.50639  train err: 0.02981
Epoch: 73  test err: 0.50232  train err: 0.02869
Epoch: 74  test err: 0.50489  train err: 0.02900
Epoch: 75  test err: 0.49918  train err: 0.02809
Epoch: 76  test err: 0.50122  train err: 0.02873
Epoch: 77  test err: 0.50477  train err: 0.02908
Epoch: 78  test err: 0.49726  train err: 0.02788
Epoch: 79  test err: 0.50449  train err: 0.02794
Epoch: 80  test err: 0.50094  train err: 0.02811